
function viewportSize(){var e=document.createElement("div");e.style.cssText="position: fixed;top: 0;left: 0;bottom: 0;right: 0;",document.documentElement.insertBefore(e,document.documentElement.firstChild);var t={width:e.offsetWidth,height:e.offsetHeight};return document.documentElement.removeChild(e),t}
$(function(){$(".js-fade").delay(4e3).fadeOut(800)}),$("#closeMessage").click(function(){$(this).parent().fadeOut()});
function positionWriteScreen(){var t=$(".write-scene"),e=viewportSize().height-154,i=t.outerWidth();t.css("min-height",e),$(".write-scene__toolbar__wrapper").css("width",i)}$(".js-descriptionBox").hide(),$(".js-descriptionButton").click(function(t){t.preventDefault(),$(".js-descriptionBox").slideToggle(),"SHOW DESCRIPTION"==$(".js-descriptionButton").text()?$(".js-descriptionButton").text("HIDE DESCRIPTION"):$(".js-descriptionButton").text("SHOW DESCRIPTION")}),positionWriteScreen(),$(window).resize(function(){positionWriteScreen()});
$(".js-scene").hide(),$(".js-current").parent().show(),$(".js-chapter").click(function(){$(this).parent().children(".js-scene").slideToggle(),$(".js-toggleTriangle").toggleClass("open")}),$(".js-expandScenes").click(function(){$(".js-scene").slideDown()}),$(".js-collapseScenes").click(function(){$(".js-scene").slideUp()}),$(".js-currentScene").click(function(){$(".js-scene").slideUp(),$(".js-current").parent().slideDown()});
$(".js-sidePanelToggle").click(function(){var s=$(".app-container"),e=$(".side-panel"),i=$(".write-scene__toolbar__wrapper");$(this).hasClass("closed")?(s.css("padding-right","360px"),i.css("padding-right","325px"),e.css("right","0"),$(this).removeClass("closed"),$(this).addClass("opened")):(s.css("padding-right","10px"),i.css("padding-right","10px"),e.css("right","-350px"),$(this).addClass("closed"),$(this).removeClass("opened"))});
!function(t){function e(t){return t.replace(/(:|\.)/g,"\\$1")}var l="1.5.0",o={},s={exclude:[],excludeWithin:[],offset:0,direction:"top",scrollElement:null,scrollTarget:null,beforeScroll:function(){},afterScroll:function(){},easing:"swing",speed:400,autoCoefficient:2,preventDefault:!0},n=function(e){var l=[],o=!1,s=e.dir&&"left"===e.dir?"scrollLeft":"scrollTop";return this.each(function(){if(this!==document&&this!==window){var e=t(this);e[s]()>0?l.push(this):(e[s](1),o=e[s]()>0,o&&l.push(this),e[s](0))}}),l.length||this.each(function(){"BODY"===this.nodeName&&(l=[this])}),"first"===e.el&&l.length>1&&(l=[l[0]]),l};t.fn.extend({scrollable:function(t){var e=n.call(this,{dir:t});return this.pushStack(e)},firstScrollable:function(t){var e=n.call(this,{el:"first",dir:t});return this.pushStack(e)},smoothScroll:function(l,o){if(l=l||{},"options"===l)return o?this.each(function(){var e=t(this),l=t.extend(e.data("ssOpts")||{},o);t(this).data("ssOpts",l)}):this.first().data("ssOpts");var s=t.extend({},t.fn.smoothScroll.defaults,l),n=t.smoothScroll.filterPath(location.pathname);return this.unbind("click.smoothscroll").bind("click.smoothscroll",function(l){var o=this,r=t(this),i=t.extend({},s,r.data("ssOpts")||{}),c=s.exclude,a=i.excludeWithin,f=0,h=0,u=!0,d={},p=location.hostname===o.hostname||!o.hostname,m=i.scrollTarget||(t.smoothScroll.filterPath(o.pathname)||n)===n,S=e(o.hash);if(i.scrollTarget||p&&m&&S){for(;u&&f<c.length;)r.is(e(c[f++]))&&(u=!1);for(;u&&h<a.length;)r.closest(a[h++]).length&&(u=!1)}else u=!1;u&&(i.preventDefault&&l.preventDefault(),t.extend(d,i,{scrollTarget:i.scrollTarget||S,link:o}),t.smoothScroll(d))}),this}}),t.smoothScroll=function(e,l){if("options"===e&&"object"==typeof l)return t.extend(o,l);var s,n,r,i,c,a=0,f="offset",h="scrollTop",u={},d={};"number"==typeof e?(s=t.extend({link:null},t.fn.smoothScroll.defaults,o),r=e):(s=t.extend({link:null},t.fn.smoothScroll.defaults,e||{},o),s.scrollElement&&(f="position","static"===s.scrollElement.css("position")&&s.scrollElement.css("position","relative"))),h="left"===s.direction?"scrollLeft":h,s.scrollElement?(n=s.scrollElement,/^(?:HTML|BODY)$/.test(n[0].nodeName)||(a=n[h]())):n=t("html, body").firstScrollable(s.direction),s.beforeScroll.call(n,s),r="number"==typeof e?e:l||t(s.scrollTarget)[f]()&&t(s.scrollTarget)[f]()[s.direction]||0,u[h]=r+a+s.offset,i=s.speed,"auto"===i&&(c=u[h]-n.scrollTop(),0>c&&(c*=-1),i=c/s.autoCoefficient),d={duration:i,easing:s.easing,complete:function(){s.afterScroll.call(s.link,s)}},s.step&&(d.step=s.step),n.length?n.stop().animate(u,d):s.afterScroll.call(s.link,s)},t.smoothScroll.version=l,t.smoothScroll.filterPath=function(t){return t=t||"",t.replace(/^\//,"").replace(/(?:index|default).[a-zA-Z]{3,4}$/,"").replace(/\/$/,"")},t.fn.smoothScroll.defaults=s}(jQuery);
!function(e){var t,o={className:"autosizejs",id:"autosizejs",append:"\n",callback:!1,resizeDelay:10,placeholder:!0},i='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',n=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","whiteSpace"],s=e(i).data("autosize",!0)[0];s.style.lineHeight="99px","99px"===e(s).css("lineHeight")&&n.push("lineHeight"),s.style.lineHeight="",e.fn.autosize=function(i){return this.length?(i=e.extend({},o,i||{}),s.parentNode!==document.body&&e(document.body).append(s),this.each(function(){function o(){var t,o=window.getComputedStyle?window.getComputedStyle(u,null):!1;o?(t=u.getBoundingClientRect().width,(0===t||"number"!=typeof t)&&(t=parseInt(o.width,10)),e.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(e,i){t-=parseInt(o[i],10)})):t=p.width(),s.style.width=Math.max(t,0)+"px"}function a(){var a={};if(t=u,s.className=i.className,s.id=i.id,d=parseInt(p.css("maxHeight"),10),e.each(n,function(e,t){a[t]=p.css(t)}),e(s).css(a).attr("wrap",p.attr("wrap")),o(),window.chrome){var r=u.style.width;u.style.width="0px";{u.offsetWidth}u.style.width=r}}function r(){var e,n;t!==u?a():o(),s.value=!u.value&&i.placeholder?(p.attr("placeholder")||"")+i.append:u.value+i.append,s.style.overflowY=u.style.overflowY,n=parseInt(u.style.height,10),s.scrollTop=0,s.scrollTop=9e4,e=s.scrollTop,d&&e>d?(u.style.overflowY="scroll",e=d):(u.style.overflowY="hidden",c>e&&(e=c)),e+=w,n!==e&&(u.style.height=e+"px",f&&i.callback.call(u,u),p.trigger("autosize.resized"))}function l(){clearTimeout(h),h=setTimeout(function(){var e=p.width();e!==g&&(g=e,r())},parseInt(i.resizeDelay,10))}var d,c,h,u=this,p=e(u),w=0,f=e.isFunction(i.callback),z={height:u.style.height,overflow:u.style.overflow,overflowY:u.style.overflowY,wordWrap:u.style.wordWrap,resize:u.style.resize},g=p.width(),y=p.css("resize");p.data("autosize")||(p.data("autosize",!0),("border-box"===p.css("box-sizing")||"border-box"===p.css("-moz-box-sizing")||"border-box"===p.css("-webkit-box-sizing"))&&(w=p.outerHeight()-p.height()),c=Math.max(parseInt(p.css("minHeight"),10)-w||0,p.height()),p.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word"}),"vertical"===y?p.css("resize","none"):"both"===y&&p.css("resize","horizontal"),"onpropertychange"in u?"oninput"in u?p.on("input.autosize keyup.autosize",r):p.on("propertychange.autosize",function(){"value"===event.propertyName&&r()}):p.on("input.autosize",r),i.resizeDelay!==!1&&e(window).on("resize.autosize",l),p.on("autosize.resize",r),p.on("autosize.resizeIncludeStyle",function(){t=null,r()}),p.on("autosize.destroy",function(){t=null,clearTimeout(h),e(window).off("resize",l),p.off("autosize").off(".autosize").css(z).removeData("autosize")}),r())})):this}}(jQuery||$);
!function(n){"use strict";function e(n){for(var e,t,r=[],o=0,i=n.length;i>o;)e=n.charCodeAt(o++),55296==(63488&e)&&i>o?(t=n.charCodeAt(o++),56320==(64512&t)?r.push(((1023&e)<<10)+(1023&t)+65536):r.push(e,t)):r.push(e);return r}function t(n,e){var t=n&&("[object NodeList]"===Object.prototype.toString.call(n)&&n.length||1===n.nodeType),r=e&&"function"==typeof e;return"console"in window&&"warn"in console&&(t||console.warn("Countable: No valid elements were found"),r||console.warn('Countable: "'+e+'" is not a valid callback function')),t&&r}function r(n){var e={hardReturns:!1,stripTags:!1,ignoreReturns:!1};for(var t in n)e.hasOwnProperty(t)&&(e[t]=n[t]);return e}function o(n,t){var r,o="value"in n?n.value:n.innerText||n.textContent;return t.stripTags&&(o=o.replace(/<\/?[a-z][^>]*>/gi,"")),r=o.trim(),{paragraphs:r?(r.match(t.hardReturns?/\n{2,}/g:/\n+/g)||[]).length+1:0,words:r?(r.replace(/['";:,.?¿\-!¡]+/g,"").match(/\S+/g)||[]).length:0,characters:r?e(r.replace(/\s/g,"")).length:0,all:e(t.ignoreReturns?o.replace(/[\n\r]/g,""):o).length}}function i(n,e){var t=n.length;if("undefined"!=typeof t)for(;t--;)e(n[t]);else e(n)}var a=[],c="oninput"in document?"input":"keyup";String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var u={live:function(n,e,u){var l=r(u),s=function(n){var t=function(){e.call(n,o(n,l))};a.push({element:n,handler:t}),t(),n.addEventListener?n.addEventListener(c,t,!1):n.attachEvent&&n.attachEvent("on"+c,t)};if(t(n,e))return n.length?i(n,s):s(n),this},die:function(n){return t(n,function(){})?(i(n,function(n){var e;i(a,function(t){t.element===n&&(e=t)}),e&&(n.removeEventListener?n.removeEventListener(c,e.handler,!1):n.detachEvent&&n.detachEvent("on"+c,e.handler),a.splice(a.indexOf(e),1))}),this):void 0},once:function(n,e,a){return t(n,e)?(i(n,function(n){e.call(n,o(n,r(a)))}),this):void 0},enabled:function(n){var e=!1;return n&&1===n.nodeType&&i(a,function(t){t.element===n&&(e=!0)}),e}};"object"==typeof exports?module.exports=u:"function"==typeof define&&define.amd?define(function(){return u}):n.Countable=u}(this);
function MediumEditor(e,t){"use strict";return this.init(e,t)}"object"==typeof module&&(module.exports=MediumEditor),function(e,t){"use strict";function i(e,t){var i;if(void 0===e)return t;for(i in t)t.hasOwnProperty(i)&&e.hasOwnProperty(i)===!1&&(e[i]=t[i]);return e}function n(e,t){for(var i=t.parentNode;null!==i;){if(i===e)return!0;i=i.parentNode}return!1}function o(){var t,i,n,o=e.getSelection();if(o.getRangeAt&&o.rangeCount){for(n=[],t=0,i=o.rangeCount;i>t;t+=1)n.push(o.getRangeAt(t));return n}return null}function r(t){var i,n,o=e.getSelection();if(t)for(o.removeAllRanges(),i=0,n=t.length;n>i;i+=1)o.addRange(t[i])}function a(){var e=t.getSelection().anchorNode,i=e&&3===e.nodeType?e.parentNode:e;return i}function s(){var i,n,o,r,a="";if(void 0!==e.getSelection){if(n=e.getSelection(),n.rangeCount){for(r=t.createElement("div"),i=0,o=n.rangeCount;o>i;i+=1)r.appendChild(n.getRangeAt(i).cloneContents());a=r.innerHTML}}else void 0!==t.selection&&"Text"===t.selection.type&&(a=t.selection.createRange().htmlText);return a}function l(e){return!(!e||1!==e.nodeType)}MediumEditor.prototype={defaults:{allowMultiParagraphSelection:!0,anchorInputPlaceholder:"Paste or type a link",anchorPreviewHideDelay:500,buttons:["bold","italic","underline","anchor","header1","header2","quote"],buttonLabels:!1,checkLinkFormat:!1,cleanPastedHTML:!1,delay:0,diffLeft:0,diffTop:-10,disableReturn:!1,disableDoubleReturn:!1,disableToolbar:!1,disableEditing:!1,elementsContainer:!1,firstHeader:"h3",forcePlainText:!0,placeholder:"Type your text",secondHeader:"h4",targetBlank:!1,anchorTarget:!1,anchorButton:!1,anchorButtonClass:"btn",extensions:{},activeButtonClass:"medium-editor-button-active",firstButtonClass:"medium-editor-button-first",lastButtonClass:"medium-editor-button-last"},isIE:"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),init:function(e,n){return this.setElementSelection(e),0!==this.elements.length?(this.parentElements=["p","h1","h2","h3","h4","h5","h6","blockquote","pre"],this.id=t.querySelectorAll(".medium-editor-toolbar").length+1,this.options=i(n,this.defaults),this.setup()):void 0},setup:function(){this.isActive=!0,this.initElements().bindSelect().bindPaste().setPlaceholders().bindWindowActions().passInstance()},initElements:function(){this.updateElementList();var e,i=!1;for(e=0;e<this.elements.length;e+=1)this.options.disableEditing||this.elements[e].getAttribute("data-disable-editing")||this.elements[e].setAttribute("contentEditable",!0),this.elements[e].getAttribute("data-placeholder")||this.elements[e].setAttribute("data-placeholder",this.options.placeholder),this.elements[e].setAttribute("data-medium-element",!0),this.bindParagraphCreation(e).bindReturn(e).bindTab(e),this.options.disableToolbar||this.elements[e].getAttribute("data-disable-toolbar")||(i=!0);return i&&(this.options.elementsContainer||(this.options.elementsContainer=t.body),this.initToolbar().bindButtons().bindAnchorForm().bindAnchorPreview()),this},setElementSelection:function(e){this.elementSelection=e,this.updateElementList()},updateElementList:function(){this.elements="string"==typeof this.elementSelection?t.querySelectorAll(this.elementSelection):this.elementSelection,1===this.elements.nodeType&&(this.elements=[this.elements])},serialize:function(){var e,t,i={};for(e=0;e<this.elements.length;e+=1)t=""!==this.elements[e].id?this.elements[e].id:"element-"+e,i[t]={value:this.elements[e].innerHTML.trim()};return i},callExtensions:function(e){if(!(arguments.length<1)){var t,i,n=Array.prototype.slice.call(arguments,1);for(i in this.options.extensions)this.options.extensions.hasOwnProperty(i)&&(t=this.options.extensions[i],void 0!==t[e]&&t[e].apply(t,n))}},passInstance:function(){var e,t,i=this;for(t in i.options.extensions)i.options.extensions.hasOwnProperty(t)&&(e=i.options.extensions[t],e.parent&&(e.base=i));return i},bindParagraphCreation:function(e){var i=this;return this.elements[e].addEventListener("keypress",function(e){var i,n=a();32===e.which&&(i=n.tagName.toLowerCase(),"a"===i&&t.execCommand("unlink",!1,null))}),this.elements[e].addEventListener("keyup",function(e){var n,o=a();o&&o.getAttribute("data-medium-element")&&0===o.children.length&&!i.options.disableReturn&&!o.getAttribute("data-disable-return")&&t.execCommand("formatBlock",!1,"p"),13===e.which&&(o=a(),n=o.tagName.toLowerCase(),i.options.disableReturn||this.getAttribute("data-disable-return")||"li"===n||i.isListItemChild(o)||(e.shiftKey||t.execCommand("formatBlock",!1,"p"),"a"===n&&t.execCommand("unlink",!1,null)))}),this},isListItemChild:function(e){for(var t=e.parentNode,i=t.tagName.toLowerCase();-1===this.parentElements.indexOf(i)&&"div"!==i;){if("li"===i)return!0;if(t=t.parentNode,!t||!t.tagName)return!1;i=t.tagName.toLowerCase()}return!1},bindReturn:function(e){var t=this;return this.elements[e].addEventListener("keypress",function(e){if(13===e.which)if(t.options.disableReturn||this.getAttribute("data-disable-return"))e.preventDefault();else if(t.options.disableDoubleReturn||this.getAttribute("data-disable-double-return")){var i=a();i&&"\n"===i.innerText&&e.preventDefault()}}),this},bindTab:function(e){return this.elements[e].addEventListener("keydown",function(e){if(9===e.which){var i=a().tagName.toLowerCase();"pre"===i&&(e.preventDefault(),t.execCommand("insertHtml",null,"    ")),"li"===i&&(e.preventDefault(),e.shiftKey?t.execCommand("outdent",e):t.execCommand("indent",e))}}),this},buttonTemplate:function(e){var t=this.getButtonLabels(this.options.buttonLabels),i={bold:'<button class="medium-editor-action medium-editor-action-bold" data-action="bold" data-element="b">'+t.bold+"</button>",italic:'<button class="medium-editor-action medium-editor-action-italic" data-action="italic" data-element="i">'+t.italic+"</button>",underline:'<button class="medium-editor-action medium-editor-action-underline" data-action="underline" data-element="u">'+t.underline+"</button>",strikethrough:'<button class="medium-editor-action medium-editor-action-strikethrough" data-action="strikethrough" data-element="strike"><strike>A</strike></button>',superscript:'<button class="medium-editor-action medium-editor-action-superscript" data-action="superscript" data-element="sup">'+t.superscript+"</button>",subscript:'<button class="medium-editor-action medium-editor-action-subscript" data-action="subscript" data-element="sub">'+t.subscript+"</button>",anchor:'<button class="medium-editor-action medium-editor-action-anchor" data-action="anchor" data-element="a">'+t.anchor+"</button>",image:'<button class="medium-editor-action medium-editor-action-image" data-action="image" data-element="img">'+t.image+"</button>",header1:'<button class="medium-editor-action medium-editor-action-header1" data-action="append-'+this.options.firstHeader+'" data-element="'+this.options.firstHeader+'">'+t.header1+"</button>",header2:'<button class="medium-editor-action medium-editor-action-header2" data-action="append-'+this.options.secondHeader+'" data-element="'+this.options.secondHeader+'">'+t.header2+"</button>",quote:'<button class="medium-editor-action medium-editor-action-quote" data-action="append-blockquote" data-element="blockquote">'+t.quote+"</button>",orderedlist:'<button class="medium-editor-action medium-editor-action-orderedlist" data-action="insertorderedlist" data-element="ol">'+t.orderedlist+"</button>",unorderedlist:'<button class="medium-editor-action medium-editor-action-unorderedlist" data-action="insertunorderedlist" data-element="ul">'+t.unorderedlist+"</button>",pre:'<button class="medium-editor-action medium-editor-action-pre" data-action="append-pre" data-element="pre">'+t.pre+"</button>",indent:'<button class="medium-editor-action medium-editor-action-indent" data-action="indent" data-element="ul">'+t.indent+"</button>",outdent:'<button class="medium-editor-action medium-editor-action-outdent" data-action="outdent" data-element="ul">'+t.outdent+"</button>"};return i[e]||!1},getButtonLabels:function(e){var t,i,n={bold:"<b>B</b>",italic:"<b><i>I</i></b>",underline:"<b><u>U</u></b>",superscript:"<b>x<sup>1</sup></b>",subscript:"<b>x<sub>1</sub></b>",anchor:"<b>#</b>",image:"<b>image</b>",header1:"<b>H1</b>",header2:"<b>H2</b>",quote:"<b>&ldquo;</b>",orderedlist:"<b>1.</b>",unorderedlist:"<b>&bull;</b>",pre:"<b>0101</b>",indent:"<b>&rarr;</b>",outdent:"<b>&larr;</b>"};if("fontawesome"===e?t={bold:'<i class="fa fa-bold"></i>',italic:'<i class="fa fa-italic"></i>',underline:'<i class="fa fa-underline"></i>',superscript:'<i class="fa fa-superscript"></i>',subscript:'<i class="fa fa-subscript"></i>',anchor:'<i class="fa fa-link"></i>',image:'<i class="fa fa-picture-o"></i>',quote:'<i class="fa fa-quote-right"></i>',orderedlist:'<i class="fa fa-list-ol"></i>',unorderedlist:'<i class="fa fa-list-ul"></i>',pre:'<i class="fa fa-code fa-lg"></i>',indent:'<i class="fa fa-indent"></i>',outdent:'<i class="fa fa-outdent"></i>'}:"object"==typeof e&&(t=e),"object"==typeof t)for(i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n},initToolbar:function(){return this.toolbar?this:(this.toolbar=this.createToolbar(),this.keepToolbarAlive=!1,this.anchorForm=this.toolbar.querySelector(".medium-editor-toolbar-form-anchor"),this.anchorInput=this.anchorForm.querySelector("input.medium-editor-toolbar-anchor-input"),this.anchorTarget=this.anchorForm.querySelector("input.medium-editor-toolbar-anchor-target"),this.anchorButton=this.anchorForm.querySelector("input.medium-editor-toolbar-anchor-button"),this.toolbarActions=this.toolbar.querySelector(".medium-editor-toolbar-actions"),this.anchorPreview=this.createAnchorPreview(),this)},createToolbar:function(){var e=t.createElement("div");return e.id="medium-editor-toolbar-"+this.id,e.className="medium-editor-toolbar",e.appendChild(this.toolbarButtons()),e.appendChild(this.toolbarFormAnchor()),this.options.elementsContainer.appendChild(e),e},toolbarButtons:function(){var e,i,n,o,r=this.options.buttons,a=t.createElement("ul");for(a.id="medium-editor-toolbar-actions",a.className="medium-editor-toolbar-actions clearfix",i=0;i<r.length;i+=1)this.options.extensions.hasOwnProperty(r[i])?(o=this.options.extensions[r[i]],n=void 0!==o.getButton?o.getButton():null):n=this.buttonTemplate(r[i]),n&&(e=t.createElement("li"),l(n)?e.appendChild(n):e.innerHTML=n,a.appendChild(e));return a},toolbarFormAnchor:function(){var e=t.createElement("div"),i=t.createElement("input"),n=t.createElement("label"),o=t.createElement("input"),r=t.createElement("label"),a=t.createElement("input"),s=t.createElement("a"),l=t.createElement("a");return s.setAttribute("href","#"),s.className="medium-editor-toobar-anchor-close",s.innerHTML="&times;",l.setAttribute("href","#"),l.className="medium-editor-toobar-anchor-save",l.innerHTML="&#10003;",i.setAttribute("type","text"),i.className="medium-editor-toolbar-anchor-input",i.setAttribute("placeholder",this.options.anchorInputPlaceholder),o.setAttribute("type","checkbox"),o.className="medium-editor-toolbar-anchor-target",n.innerHTML="Open in New Window?",n.insertBefore(o,n.firstChild),a.setAttribute("type","checkbox"),a.className="medium-editor-toolbar-anchor-button",r.innerHTML="Button",r.insertBefore(a,r.firstChild),e.className="medium-editor-toolbar-form-anchor",e.id="medium-editor-toolbar-form-anchor",e.appendChild(i),e.appendChild(l),e.appendChild(s),this.options.anchorTarget&&e.appendChild(n),this.options.anchorButton&&e.appendChild(r),e},bindSelect:function(){var e,i=this,n="";for(this.checkSelectionWrapper=function(e){return e&&i.clickingIntoArchorForm(e)?!1:(clearTimeout(n),n=setTimeout(function(){i.checkSelection()},i.options.delay),void 0)},t.documentElement.addEventListener("mouseup",this.checkSelectionWrapper),e=0;e<this.elements.length;e+=1)this.elements[e].addEventListener("keyup",this.checkSelectionWrapper),this.elements[e].addEventListener("blur",this.checkSelectionWrapper);return this},checkSelection:function(){var t,i;return this.keepToolbarAlive===!0||this.options.disableToolbar||(t=e.getSelection(),""===t.toString().trim()||this.options.allowMultiParagraphSelection===!1&&this.hasMultiParagraphs()||this.selectionInContentEditableFalse()?this.hideToolbarActions():(i=this.getSelectionElement(),!i||i.getAttribute("data-disable-toolbar")?this.hideToolbarActions():this.checkSelectionElement(t,i))),this},clickingIntoArchorForm:function(e){var t=this;return e.type&&"blur"===e.type.toLowerCase()&&e.relatedTarget&&e.relatedTarget===t.anchorInput?!0:!1},hasMultiParagraphs:function(){var e=s().replace(/<[\S]+><\/[\S]+>/gim,""),t=e.match(/<(p|h[0-6]|blockquote)>([\s\S]*?)<\/(p|h[0-6]|blockquote)>/g);return t?t.length:0},checkSelectionElement:function(e,t){var i;for(this.selection=e,this.selectionRange=this.selection.getRangeAt(0),i=0;i<this.elements.length;i+=1)if(this.elements[i]===t)return this.setToolbarButtonStates().setToolbarPosition().showToolbarActions(),void 0;this.hideToolbarActions()},findMatchingSelectionParent:function(t){var i,n,o=e.getSelection();if(0===o.rangeCount)return!1;i=o.getRangeAt(0),n=i.commonAncestorContainer;do{if(1===n.nodeType){if(t(n))return n;if(n.getAttribute("data-medium-element"))return!1}n=n.parentNode}while(n);return!1},getSelectionElement:function(){return this.findMatchingSelectionParent(function(e){return e.getAttribute("data-medium-element")})},selectionInContentEditableFalse:function(){return this.findMatchingSelectionParent(function(e){return e&&"#text"!==e.nodeName&&"false"===e.getAttribute("contenteditable")})},setToolbarPosition:function(){var t=50,i=e.getSelection(),n=i.getRangeAt(0),o=n.getBoundingClientRect(),r=this.options.diffLeft-this.toolbar.offsetWidth/2,a=(o.left+o.right)/2,s=this.toolbar.offsetWidth/2;return o.top<t?(this.toolbar.classList.add("medium-toolbar-arrow-over"),this.toolbar.classList.remove("medium-toolbar-arrow-under"),this.toolbar.style.top=t+o.bottom-this.options.diffTop+e.pageYOffset-this.toolbar.offsetHeight+"px"):(this.toolbar.classList.add("medium-toolbar-arrow-under"),this.toolbar.classList.remove("medium-toolbar-arrow-over"),this.toolbar.style.top=o.top+this.options.diffTop+e.pageYOffset-this.toolbar.offsetHeight+"px"),this.toolbar.style.left=s>a?r+s+"px":e.innerWidth-a<s?e.innerWidth+r-s+"px":r+a+"px",this.hideAnchorPreview(),this},setToolbarButtonStates:function(){var e,t=this.toolbarActions.querySelectorAll("button");for(e=0;e<t.length;e+=1)t[e].classList.remove(this.options.activeButtonClass);return this.checkActiveButtons(),this},checkActiveButtons:function(){for(var e=Array.prototype.slice.call(this.elements),t=this.getSelectedParentElement();void 0!==t.tagName&&-1===this.parentElements.indexOf(t.tagName.toLowerCase)&&(this.activateButton(t.tagName.toLowerCase()),this.callExtensions("checkState",t),-1===e.indexOf(t));)t=t.parentNode},activateButton:function(e){var t=this.toolbar.querySelector('[data-element="'+e+'"]');null!==t&&-1===t.className.indexOf(this.options.activeButtonClass)&&(t.className+=" "+this.options.activeButtonClass)},bindButtons:function(){var e,t=this.toolbar.querySelectorAll("button"),i=this,n=function(e){e.preventDefault(),e.stopPropagation(),void 0===i.selection&&i.checkSelection(),this.className.indexOf(i.options.activeButtonClass)>-1?this.classList.remove(i.options.activeButtonClass):this.className+=" "+i.options.activeButtonClass,this.hasAttribute("data-action")&&i.execAction(this.getAttribute("data-action"),e)};for(e=0;e<t.length;e+=1)t[e].addEventListener("click",n);return this.setFirstAndLastItems(t),this},setFirstAndLastItems:function(e){return e.length>0&&(e[0].className+=" "+this.options.firstButtonClass,e[e.length-1].className+=" "+this.options.lastButtonClass),this},execAction:function(i,n){i.indexOf("append-")>-1?(this.execFormatBlock(i.replace("append-","")),this.setToolbarPosition(),this.setToolbarButtonStates()):"anchor"===i?this.triggerAnchorAction(n):"image"===i?t.execCommand("insertImage",!1,e.getSelection()):(t.execCommand(i,!1,null),this.setToolbarPosition())},rangeSelectsSingleNode:function(e){var t=e.startContainer;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===e.startOffset+1},getSelectedParentElement:function(){var e=null,t=this.selectionRange;return e=this.rangeSelectsSingleNode(t)?t.startContainer.childNodes[t.startOffset]:3===t.startContainer.nodeType?t.startContainer.parentNode:t.startContainer},triggerAnchorAction:function(){var e=this.getSelectedParentElement();return e.tagName&&"a"===e.tagName.toLowerCase()?t.execCommand("unlink",!1,null):"block"===this.anchorForm.style.display?this.showToolbarActions():this.showAnchorForm(),this},execFormatBlock:function(e){var i=this.getSelectionData(this.selection.anchorNode);if("blockquote"===e&&i.el&&"blockquote"===i.el.parentNode.tagName.toLowerCase())return t.execCommand("outdent",!1,null);if(i.tagName===e&&(e="p"),this.isIE){if("blockquote"===e)return t.execCommand("indent",!1,e);e="<"+e+">"}return t.execCommand("formatBlock",!1,e)},getSelectionData:function(e){var t;for(e&&e.tagName&&(t=e.tagName.toLowerCase());e&&-1===this.parentElements.indexOf(t);)e=e.parentNode,e&&e.tagName&&(t=e.tagName.toLowerCase());return{el:e,tagName:t}},getFirstChild:function(e){for(var t=e.firstChild;null!==t&&1!==t.nodeType;)t=t.nextSibling;return t},hideToolbarActions:function(){this.keepToolbarAlive=!1,void 0!==this.toolbar&&this.toolbar.classList.remove("medium-editor-toolbar-active")},showToolbarActions:function(){var e,t=this;this.anchorForm.style.display="none",this.toolbarActions.style.display="block",this.keepToolbarAlive=!1,clearTimeout(e),e=setTimeout(function(){t.toolbar&&!t.toolbar.classList.contains("medium-editor-toolbar-active")&&t.toolbar.classList.add("medium-editor-toolbar-active")},100)},saveSelection:function(){this.savedSelection=o()},restoreSelection:function(){r(this.savedSelection)},showAnchorForm:function(e){this.toolbarActions.style.display="none",this.saveSelection(),this.anchorForm.style.display="block",this.setToolbarPosition(),this.keepToolbarAlive=!0,this.anchorInput.focus(),this.anchorInput.value=e||""},bindAnchorForm:function(){var e=this.anchorForm.querySelector("a.medium-editor-toobar-anchor-close"),i=this.anchorForm.querySelector("a.medium-editor-toobar-anchor-save"),o=this;return this.anchorForm.addEventListener("click",function(e){e.stopPropagation(),o.keepToolbarAlive=!0}),this.anchorInput.addEventListener("keyup",function(e){var t,i=null;13===e.keyCode&&(e.preventDefault(),t=o.options.anchorTarget&&o.anchorTarget.checked?"_blank":"_self",o.options.anchorButton&&o.anchorButton.checked&&(i=o.options.anchorButtonClass),o.createLink(this,t,i))}),i.addEventListener("click",function(e){var t,i=null;e.preventDefault(),t=o.options.anchorTarget&&o.anchorTarget.checked?"_blank":"_self",o.options.anchorButton&&o.anchorButton.checked&&(i=o.options.anchorButtonClass),o.createLink(o.anchorInput,t,i)},!0),this.anchorInput.addEventListener("click",function(e){e.stopPropagation(),o.keepToolbarAlive=!0}),t.body.addEventListener("click",function(e){e.target===o.anchorForm||n(o.anchorForm,e.target)||n(o.toolbarActions,e.target)||(o.keepToolbarAlive=!1,o.checkSelection())},!0),t.body.addEventListener("focus",function(e){e.target===o.anchorForm||n(o.anchorForm,e.target)||n(o.toolbarActions,e.target)||(o.keepToolbarAlive=!1,o.checkSelection())},!0),e.addEventListener("click",function(e){e.preventDefault(),o.showToolbarActions(),r(o.savedSelection)}),this},hideAnchorPreview:function(){this.anchorPreview.classList.remove("medium-editor-anchor-preview-active")},showAnchorPreview:function(t){if(this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")||t.getAttribute("data-disable-preview"))return!0;var i,n,o,r=this,a=40,s=t.getBoundingClientRect(),l=(s.left+s.right)/2;return r.anchorPreview.querySelector("i").textContent=t.href,i=r.anchorPreview.offsetWidth/2,n=r.options.diffLeft-i,clearTimeout(o),o=setTimeout(function(){r.anchorPreview&&!r.anchorPreview.classList.contains("medium-editor-anchor-preview-active")&&r.anchorPreview.classList.add("medium-editor-anchor-preview-active")},100),r.observeAnchorPreview(t),r.anchorPreview.classList.add("medium-toolbar-arrow-over"),r.anchorPreview.classList.remove("medium-toolbar-arrow-under"),r.anchorPreview.style.top=Math.round(a+s.bottom-r.options.diffTop+e.pageYOffset-r.anchorPreview.offsetHeight)+"px",r.anchorPreview.style.left=i>l?n+i+"px":e.innerWidth-l<i?e.innerWidth+n-i+"px":n+l+"px",this},observeAnchorPreview:function(e){var t=this,i=(new Date).getTime(),n=!0,o=function(){i=(new Date).getTime(),n=!0},r=function(e){e.relatedTarget&&/anchor-preview/.test(e.relatedTarget.className)||(n=!1)},a=setInterval(function(){if(n)return!0;var s=(new Date).getTime()-i;s>t.options.anchorPreviewHideDelay&&(t.hideAnchorPreview(),clearInterval(a),t.anchorPreview.removeEventListener("mouseover",o),t.anchorPreview.removeEventListener("mouseout",r),e.removeEventListener("mouseover",o),e.removeEventListener("mouseout",r))},200);t.anchorPreview.addEventListener("mouseover",o),t.anchorPreview.addEventListener("mouseout",r),e.addEventListener("mouseover",o),e.addEventListener("mouseout",r)},createAnchorPreview:function(){var e=this,i=t.createElement("div");return i.id="medium-editor-anchor-preview-"+this.id,i.className="medium-editor-anchor-preview",i.innerHTML=this.anchorPreviewTemplate(),this.options.elementsContainer.appendChild(i),i.addEventListener("click",function(){e.anchorPreviewClickHandler()}),i},anchorPreviewTemplate:function(){return'<div class="medium-editor-toolbar-anchor-preview" id="medium-editor-toolbar-anchor-preview">    <i class="medium-editor-toolbar-anchor-preview-inner"></i></div>'},anchorPreviewClickHandler:function(){if(this.activeAnchor){var i=this,n=t.createRange(),o=e.getSelection();n.selectNodeContents(i.activeAnchor),o.removeAllRanges(),o.addRange(n),setTimeout(function(){i.activeAnchor&&i.showAnchorForm(i.activeAnchor.href),i.keepToolbarAlive=!1},100+i.options.delay)}this.hideAnchorPreview()},editorAnchorObserver:function(e){var t=this,i=!0,n=function(){i=!1,t.activeAnchor.removeEventListener("mouseout",n)};if(e.target&&"a"===e.target.tagName.toLowerCase()){if(!/href=["']\S+["']/.test(e.target.outerHTML)||/href=["']#\S+["']/.test(e.target.outerHTML))return!0;if(this.toolbar.classList.contains("medium-editor-toolbar-active"))return!0;this.activeAnchor=e.target,this.activeAnchor.addEventListener("mouseout",n),setTimeout(function(){i&&t.showAnchorPreview(e.target)},t.options.delay)}},bindAnchorPreview:function(){var e,t=this;for(this.editorAnchorObserverWrapper=function(e){t.editorAnchorObserver(e)},e=0;e<this.elements.length;e+=1)this.elements[e].addEventListener("mouseover",this.editorAnchorObserverWrapper);return this},checkLinkFormat:function(e){var t=/^(https?|ftps?|rtmpt?):\/\/|mailto:/;return(t.test(e)?"":"http://")+e},setTargetBlank:function(){var e,t=a();if("a"===t.tagName.toLowerCase())t.target="_blank";else for(t=t.getElementsByTagName("a"),e=0;e<t.length;e+=1)t[e].target="_blank"},setButtonClass:function(e){var t,i,n=a(),o=e.split(" ");if("a"===n.tagName.toLowerCase())for(i=0;i<o.length;i+=1)n.classList.add(o[i]);else for(n=n.getElementsByTagName("a"),t=0;t<n.length;t+=1)for(i=0;i<o.length;i+=1)n[t].classList.add(o[i])},createLink:function(i,n,o){var a,s;if(0===i.value.trim().length)return this.hideToolbarActions(),void 0;if(r(this.savedSelection),this.options.checkLinkFormat&&(i.value=this.checkLinkFormat(i.value)),t.execCommand("createLink",!1,i.value),(this.options.targetBlank||"_blank"===n)&&this.setTargetBlank(),o&&this.setButtonClass(o),this.options.targetBlank||"_blank"===n||o)for(s=t.createEvent("HTMLEvents"),s.initEvent("input",!0,!0,e),a=0;a<this.elements.length;a+=1)this.elements[a].dispatchEvent(s);this.checkSelection(),this.showToolbarActions(),i.value=""},bindWindowActions:function(){var t,i=this;return this.windowResizeHandler=function(){clearTimeout(t),t=setTimeout(function(){i.toolbar&&i.toolbar.classList.contains("medium-editor-toolbar-active")&&i.setToolbarPosition()},100)},e.addEventListener("resize",this.windowResizeHandler),this},activate:function(){this.isActive||this.setup()},deactivate:function(){var i;if(this.isActive)for(this.isActive=!1,void 0!==this.toolbar&&(this.options.elementsContainer.removeChild(this.anchorPreview),this.options.elementsContainer.removeChild(this.toolbar),delete this.toolbar,delete this.anchorPreview),t.documentElement.removeEventListener("mouseup",this.checkSelectionWrapper),e.removeEventListener("resize",this.windowResizeHandler),i=0;i<this.elements.length;i+=1)this.elements[i].removeEventListener("mouseover",this.editorAnchorObserverWrapper),this.elements[i].removeEventListener("keyup",this.checkSelectionWrapper),this.elements[i].removeEventListener("blur",this.checkSelectionWrapper),this.elements[i].removeEventListener("paste",this.pasteWrapper),this.elements[i].removeAttribute("contentEditable"),this.elements[i].removeAttribute("data-medium-element")},htmlEntities:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},bindPaste:function(){var e,i=this;for(this.pasteWrapper=function(e){var n,o,r="";if(this.classList.remove("medium-editor-placeholder"),!i.options.forcePlainText&&!i.options.cleanPastedHTML)return this;if(e.clipboardData&&e.clipboardData.getData&&!e.defaultPrevented){if(e.preventDefault(),i.options.cleanPastedHTML&&e.clipboardData.getData("text/html"))return i.cleanPaste(e.clipboardData.getData("text/html"));if(i.options.disableReturn||this.getAttribute("data-disable-return"))t.execCommand("insertHTML",!1,e.clipboardData.getData("text/plain"));else{for(n=e.clipboardData.getData("text/plain").split(/[\r\n]/g),o=0;o<n.length;o+=1)""!==n[o]&&(r+=navigator.userAgent.match(/firefox/i)&&0===o?i.htmlEntities(n[o]):"<p>"+i.htmlEntities(n[o])+"</p>");t.execCommand("insertHTML",!1,r)}}},e=0;e<this.elements.length;e+=1)this.elements[e].addEventListener("paste",this.pasteWrapper);return this},setPlaceholders:function(){var e,t=function(e){e.querySelector("img")||e.querySelector("blockquote")||""!==e.textContent.replace(/^\s+|\s+$/g,"")||e.classList.add("medium-editor-placeholder")},i=function(e){this.classList.remove("medium-editor-placeholder"),"keypress"!==e.type&&t(this)};for(e=0;e<this.elements.length;e+=1)t(this.elements[e]),this.elements[e].addEventListener("blur",i),this.elements[e].addEventListener("keypress",i);return this},cleanPaste:function(e){var i,n,o,r=this.getSelectionElement(),a=/<p|<br|<div/.test(e),s=[[new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi),""],[new RegExp(/<\/b>(<br[^>]*>)?$/gi),""],[new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g)," "],[new RegExp(/<br class="Apple-interchange-newline">/g),"<br>"],[new RegExp(/<span[^>]*(font-style:italic;font-weight:bold|font-weight:bold;font-style:italic)[^>]*>/gi),'<span class="replace-with italic bold">'],[new RegExp(/<span[^>]*font-style:italic[^>]*>/gi),'<span class="replace-with italic">'],[new RegExp(/<span[^>]*font-weight:bold[^>]*>/gi),'<span class="replace-with bold">'],[new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi),"<$1$2>"],[new RegExp(/&lt;a\s+href=(&quot;|&rdquo;|&ldquo;|“|”)([^&]+)(&quot;|&rdquo;|&ldquo;|“|”)&gt;/gi),'<a href="$2">']];for(i=0;i<s.length;i+=1)e=e.replace(s[i][0],s[i][1]);if(a)for(n=e.split("<br><br>"),this.pasteHTML("<p>"+n.join("</p><p>")+"</p>"),t.execCommand("insertText",!1,"\n"),n=r.querySelectorAll("p,div,br"),i=0;i<n.length;i+=1)switch(o=n[i],o.tagName.toLowerCase()){case"p":case"div":this.filterCommonBlocks(o);break;case"br":this.filterLineBreak(o)}else this.pasteHTML(e)},pasteHTML:function(e){var i,n,o,r,a=t.createDocumentFragment();for(a.appendChild(t.createElement("body")),r=a.querySelector("body"),r.innerHTML=e,this.cleanupSpans(r),i=r.querySelectorAll("*"),o=0;o<i.length;o+=1)n=i[o],n.removeAttribute("class"),n.removeAttribute("style"),n.removeAttribute("dir"),"meta"===n.tagName.toLowerCase()&&n.parentNode.removeChild(n);t.execCommand("insertHTML",!1,r.innerHTML.replace(/&nbsp;/g," "))},isCommonBlock:function(e){return e&&("p"===e.tagName.toLowerCase()||"div"===e.tagName.toLowerCase())},filterCommonBlocks:function(e){/^\s*$/.test(e.innerText)&&e.parentNode.removeChild(e)},filterLineBreak:function(e){this.isCommonBlock(e.previousElementSibling)?e.parentNode.removeChild(e):!this.isCommonBlock(e.parentNode)||e.parentNode.firstChild!==e&&e.parentNode.lastChild!==e?1===e.parentNode.childElementCount&&this.removeWithParent(e):e.parentNode.removeChild(e)},removeWithParent:function(e){e&&e.parentNode&&(e.parentNode.parentNode&&1===e.parentNode.childElementCount?e.parentNode.parentNode.removeChild(e.parentNode):e.parentNode.removeChild(e.parentNode))},cleanupSpans:function(e){var i,n,o,r=e.querySelectorAll(".replace-with");for(i=0;i<r.length;i+=1)n=r[i],o=t.createElement(n.classList.contains("bold")?"b":"i"),o.innerHTML=n.classList.contains("bold")&&n.classList.contains("italic")?"<i>"+n.innerHTML+"</i>":n.innerHTML,n.parentNode.replaceChild(o,n);for(r=e.querySelectorAll("span"),i=0;i<r.length;i+=1)n=r[i],/^\s*$/.test()?n.parentNode.removeChild(n):n.parentNode.replaceChild(t.createTextNode(n.innerText),n)}}}(window,document);
$(".editable").each(function(){var e=$(this);e.wrap('<div class="editable-wrapper"/>');var i=$(this).parent();i.prepend('<div id="js-countable" class="editable">'+e.val()+"</div>"),e.hide();new MediumEditor(".editable",{buttons:["bold","italic","underline","header1","header2"],placeholder:"Start typing here...highlight to edit"})}),$("form").submit(function(){$(".editable-wrapper").each(function(){$(this).find("textarea").val($(this).find(".editable").html())})});
$(document).ready(function(){var e=document.getElementById("js-countable"),n=document.getElementById("word-count");Countable.live(e,function(e){n.innerText=e.words},{stripTags:!0})});